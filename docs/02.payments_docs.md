# 결제 모듈 프로젝트

## 프로젝트 개요

이 결제 모듈은 카드를 등록하고 결제할 수 있게 도와주는 모달 컴포넌트입니다.

참여한 팀원: 정민지

## 개발 환경

Framework: React 18.2.0

Language: JavaScript (ES6+), JSX

State Management: React Hooks (Context API, useState, useContext)

Build Tool: Create React App

Styling: CSS

## 설치 및 실행 방법
프로젝트를 로컬에 복제합니다. git clone <저장소_URL>

프로젝트 디렉토리로 이동합니다. cd <프로젝트_폴더명>

필요한 패키지를 설치합니다. npm install

개발 서버를 실행합니다. npm start

브라우저에서 http://localhost:3000으로 접속하여 확인합니다.

## 컴포넌트 구조

App: 최상위 컴포넌트. 모든 컴포넌트를 CartProvider와 PaymentProvider로 감싸 전역 상태를 관리합니다.

PaymentProvider (Context): 결제와 관련된 모든 상태와 로직을 관리합니다. (모달 열림/닫힘, 카드 목록, 카드 추가, 결제 처리 등). Firestore와 통신하여 사용자의 카드 목록을 실시간으로 동기화합니다.

Header: (업데이트됨) 장바구니 상품 개수를 표시하고, '결제하기' 버튼을 포함합니다. 이 버튼 클릭 시 장바구니가 비어있지 않으면 PaymentProvider의 상태를 변경하여 결제 모달을 엽니다.

PaymentModal: 결제 프로세스 전체를 감싸는 모달 컴포넌트입니다. 현재 뷰('카드 목록' 또는 '새 카드 등록')를 관리합니다.

CardList: PaymentProvider로부터 Firestore에 저장된 카드 목록을 받아와 화면에 렌더링합니다. 각 카드는 마스킹 처리되어(예: **** **** **** 1234) 표시되며, 사용자가 결제할 카드를 선택할 수 있습니다.

CardRegistrationForm: 새 카드를 등록하기 위한 폼입니다. 카드 번호, 유효 기간, CVC, 별칭을 입력받습니다. (보안) 폼 제출 시, 카드 번호 원본은 저장하지 않고 마지막 4자리, 카드 브랜드, 가상의 결제 토큰만 생성하여 Firestore에 저장합니다.

ProductListPage, ProductList, ProductCard, CartProvider: 기존 상품 목록 및 장바구니 관련 컴포넌트.

## 테스트 방법

테스트 케이스 및 실행 방법

자동 테스트:
npm test

수동 테스트 시나리오:
1. 상품 목록 페이지에서 상품을 1개 이상 장바구니에 담습니다.
2. 우측 상단 '결제하기' 버튼을 클릭하여 결제 모달이 정상적으로 나타나는지 확인합니다.
3. '새 카드 추가' 버튼을 클릭하여 카드 등록 폼으로 이동하는지 확인합니다.
4. 카드 정보를 입력하고(테스트용 아무 번호) '등록하기' 버튼을 클릭합니다.
5. (보안 테스트) Firestore 콘솔에서 artifacts/{appId}/users/{userId}/cards 문서를 확인하여, 카드 번호 원본, 유효 기간, CVC가 저장되지 않고 last4, brand, nickname, token 필드만 저장되었는지 검증합니다.
6. 카드 목록 화면으로 돌아와, 방금 등록한 카드가 마스킹된 상태(**** **** **** 1234)로 목록에 나타나는지 확인합니다.
7. 다른 카드를 여러 개 추가하여 '여러 개 카드 등록' 요구사항이 충족되는지 확인합니다.
8. 특정 카드를 선택한 후 '결제하기' 버튼을 눌러, 결제 성공(시뮬레이션) 메시지가 나타나는지 확인합니다.


## 유의사항 및 알려진 이슈

보안 관련: 본 모듈은 실제 결제 대행사(PSP)를 연동하지 않은 시뮬레이션입니다. 카드 등록 시 실제 카드 정보는 서버로 전송되거나 저장되지 않으며, 오직 '마지막 4자리'와 '가상 토큰'만을 Firestore에 저장하여 보안 요구사항을 준수하는 척 '흉내'냅다.

## 추가 항목

배포 및 피드백 (Fast URL): 요구하신 '중간 결과물 확인'을 위해, 이 React 앱은 Vercel 또는 Netlify에 배포될 수 있습니다. 배포 시 __firebase_config와 __initial_auth_token 환경 변수를 빌드 설정에 올바르게 주입해야 Firestore 연동이 정상적으로 작동합니다.
